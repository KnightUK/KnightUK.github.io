<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>Android夜间模式最佳实践 | FangYuan&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Android夜间模式最佳实践如何优雅地实现夜间模式？由于Android的设置中并没有夜间模式的选项，对于喜欢睡前玩手机的用户，只能简单的调节手机屏幕亮度来改善体验。目前越来越多的应用开始把夜间模式加到自家应用中，没准不久google也会把这项功能添加到Android系统中吧。
业内关于夜间模式的实现，有两种主流方案，各有其利弊，我较为推崇第三种方案:1、通过切换theme来实现夜间模式。2、通过">
<meta property="og:type" content="article">
<meta property="og:title" content="Android夜间模式最佳实践">
<meta property="og:url" content="http://www.baoxiang.org.cn/2016/01/30/Android夜间模式最佳实践/index.html">
<meta property="og:site_name" content="FangYuan's Blog">
<meta property="og:description" content="Android夜间模式最佳实践如何优雅地实现夜间模式？由于Android的设置中并没有夜间模式的选项，对于喜欢睡前玩手机的用户，只能简单的调节手机屏幕亮度来改善体验。目前越来越多的应用开始把夜间模式加到自家应用中，没准不久google也会把这项功能添加到Android系统中吧。
业内关于夜间模式的实现，有两种主流方案，各有其利弊，我较为推崇第三种方案:1、通过切换theme来实现夜间模式。2、通过">
<meta property="og:updated_time" content="2016-01-30T12:31:15.205Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android夜间模式最佳实践">
<meta name="twitter:description" content="Android夜间模式最佳实践如何优雅地实现夜间模式？由于Android的设置中并没有夜间模式的选项，对于喜欢睡前玩手机的用户，只能简单的调节手机屏幕亮度来改善体验。目前越来越多的应用开始把夜间模式加到自家应用中，没准不久google也会把这项功能添加到Android系统中吧。
业内关于夜间模式的实现，有两种主流方案，各有其利弊，我较为推崇第三种方案:1、通过切换theme来实现夜间模式。2、通过">
  
    <link rel="alternative" href="/atom.xml" title="FangYuan&#39;s Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/1.jpg">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  
  
<script type="text/javascript">
#�����İٶ�ͳ�ƴ���
</script>

  
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/a.png" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Fang Yuan</a></h1>
		</hgroup>

		
		<p class="header-subtitle">Android Developer</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>標籤</li>
						
						<li>友情链接</li>
						
						
						<li>關於</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/2016/01/29/resume/">关于我</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="https://github.com/KnightUK" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="http://weibo.com/2618252081/profile?rightmod=1&wvr=6&mod=personinfo&is_all=1" title="weibo">weibo</a>
					        
								<a class="google" target="_blank" href="https://plus.google.com/u/0/" title="google">google</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Android代码/" style="font-size: 15px;">Android代码</a> <a href="/tags/Android开发/" style="font-size: 20px;">Android开发</a> <a href="/tags/Android文章/" style="font-size: 15px;">Android文章</a> <a href="/tags/Android深度文/" style="font-size: 10px;">Android深度文</a> <a href="/tags/Android黑科技/" style="font-size: 10px;">Android黑科技</a> <a href="/tags/markdown用法/" style="font-size: 10px;">markdown用法</a> <a href="/tags/个人/" style="font-size: 10px;">个人</a> <a href="/tags/文章/" style="font-size: 10px;">文章</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.liaohuqiu.net/">秋壕</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://androidperformance.com/">高爷</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/singwhatiwanna">任主席</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.daimajia.com/">代码家</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/innost">邓老师</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://vmatianyu.cn/">Liter</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.trinea.cn/">Trinea</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/bboyfeiyu">Mr.Simple</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.dreamtobe.cn/">Jacksgong</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.race604.com/">Android笔记</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">kymjs张涛</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://chenqichao.me/">启超的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.fangjie.info/">方杰的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.isming.me/">码农明明桑</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://droidyue.com/">技术小黑屋</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/eclipsexys">Tomcat的猫</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://blog.csdn.net/guolin_blog">郭霖的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://drakeet.me/">Drakeet的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://zmywly8866.github.io/">张明远的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.liaoxuefeng.com/">廖雪峰的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://itangqi.me/">QI TANGS BLOG</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://c4fun.cn/">Code 4 Fun</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://ontheroad.sinaapp.com/">Tian Jun-Find My Way</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">me.findViewById(R.id.World);</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Fang Yuan</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="/a.png" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">Fang Yuan</h1>
			</hgroup>
			
			<p class="header-subtitle">Android Developer</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/2016/01/29/resume/">关于我</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="https://github.com/KnightUK" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="http://weibo.com/2618252081/profile?rightmod=1&wvr=6&mod=personinfo&is_all=1" title="weibo">weibo</a>
			        
						<a class="google" target="_blank" href="https://plus.google.com/u/0/" title="google">google</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap"><article id="post-Android夜间模式最佳实践" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/01/30/Android夜间模式最佳实践/" class="article-date">
  	<time datetime="2016-01-30T12:19:49.000Z" itemprop="datePublished">2016-01-30</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Android夜间模式最佳实践
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android代码/">Android代码</a></li></ul>
	</div>

        

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Android_u591C_u95F4_u6A21_u5F0F_u6700_u4F73_u5B9E_u8DF5"><a href="#Android_u591C_u95F4_u6A21_u5F0F_u6700_u4F73_u5B9E_u8DF5" class="headerlink" title="Android夜间模式最佳实践"></a>Android夜间模式最佳实践</h1><h2 id="u5982_u4F55_u4F18_u96C5_u5730_u5B9E_u73B0_u591C_u95F4_u6A21_u5F0F_uFF1F"><a href="#u5982_u4F55_u4F18_u96C5_u5730_u5B9E_u73B0_u591C_u95F4_u6A21_u5F0F_uFF1F" class="headerlink" title="如何优雅地实现夜间模式？"></a>如何优雅地实现夜间模式？</h2><p>由于Android的设置中并没有夜间模式的选项，对于喜欢睡前玩手机的用户，只能简单的调节手机屏幕亮度来改善体验。目前越来越多的应用开始把夜间模式加到自家应用中，没准不久google也会把这项功能添加到Android系统中吧。</p>
<p>业内关于夜间模式的实现，有两种主流方案，各有其利弊，我较为推崇第三种方案:<br>1、通过切换theme来实现夜间模式。<br>2、通过资源id映射的方式来实现夜间模式。<br>3、通过修改uiMode来切换夜间模式。</p>
<p>值得一提的是，上面提到的几种方案，都是资源内嵌在Apk中的方案，像新浪微博那种需要通过下载方式实现的夜间模式方案，网上有很多介绍，这里不去讨论。</p>
<p>下面简要描述下几种方案的实现原理：</p>
<h3 id="u4E00_u3001_u901A_u8FC7_u5207_u6362theme_u6765_u5B9E_u73B0_u591C_u95F4_u6A21_u5F0F"><a href="#u4E00_u3001_u901A_u8FC7_u5207_u6362theme_u6765_u5B9E_u73B0_u591C_u95F4_u6A21_u5F0F" class="headerlink" title="一、通过切换theme来实现夜间模式"></a>一、通过切换theme来实现夜间模式</h3><p>首先在attrs.xml中，为需要随theme变化的内容定义属性</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;resources&gt;
    &lt;attr name=&quot;textColor&quot; format=&quot;color|reference&quot; /&gt;
    &lt;attr name=&quot;mainBackground&quot; format=&quot;color|reference&quot; /&gt;
&lt;/resources&gt;
</code></pre><p>其次在不同的theme中，对属性设置不同的值，在styles.xml中定义theme如下</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;resources&gt;
    &lt;!-- 默认 --&gt;
    &lt;style name=&quot;ThemeDefault&quot; parent=&quot;Theme.AppCompat.Light.DarkActionBar&quot;&gt;
        &lt;item name=&quot;mainBackground&quot;&gt;#ffffff&lt;/item&gt;
        &lt;item name=&quot;textColor&quot;&gt;#000000&lt;/item&gt;
    &lt;/style&gt;
    &lt;!-- 夜间 --&gt;
    &lt;style name=&quot;ThemeNight&quot; parent=&quot;Theme.AppCompat.Light.DarkActionBar&quot;&gt;
        &lt;item name=&quot;mainBackground&quot;&gt;#000000&lt;/item&gt;
        &lt;item name=&quot;textColor&quot;&gt;#ffffff&lt;/item&gt;
    &lt;/style&gt;
&lt;/resources&gt;
</code></pre><p>在布局文件中使用对应的值，通过?attr/属性名，来获取不同theme对应的值。</p>
<pre><code>&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    android=&quot;@+id/main_screen&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:orientation=&quot;vertical&quot;
    android:background=&quot;?attr/mainBackground&quot;&gt;
    &lt;Button
        android:id=&quot;@+id/button&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:layout_gravity=&quot;center&quot;
        android:text=&quot;改变Theme&quot;
        android:onClick=&quot;changeTheme&quot;
        android:textColor=&quot;?attr/textColor&quot;/&gt;
&lt;/LinearLayout&gt;
</code></pre><p>在Activity中调用如下changeTheme方法，其中isNightMode为一个全局变量用来标记当前是否为夜间模式，在设置完theme后，还需要调用restartActivity或者setContentView重新刷新UI。</p>
<pre><code>public void changeTheme() {
    if (isNightMode) {
        setTheme(R.style.ThemeDefault);
        isNightMode = false;
    } else {
        setTheme(R.style.ThemeNight);
        isNightMode = true;
    }
    setContentView(R.layout.activity_main);
}        
</code></pre><p>到此即完成了一个夜间模式的简单实现，包括Google自家在内的很多应用都是采用此种方式实现夜间模式的，这应该也是Android官方推荐的方式。</p>
<p>但这种方式有一些不足，规模较大的应用，需要随theme变化的属性会很多，都需要逐一定义，有点麻烦，另外一个缺点是要使得新theme生效，一般需要restartActivity来切换UI，会导致切换主题时界面闪烁。</p>
<p>不过也可以通过调用如下updateTheme方法，只更新需要更新的部分，规避闪烁问题，只是需要写上一堆updateTheme方法。</p>
<pre><code>private void updateTheme() {
    TypedValue typedValue = new TypedValue();
    Resources.Theme theme = getTheme();
    theme.resolveAttribute(R.attr.textColor, typedValue, true);
    findViewById(R.id.button).setBackgroundColor(typedValue.data);
    theme.resolveAttribute(R.attr.mainBackground, typedValue, true);
    findViewById(R.id.main_screen).setBackgroundColor(typedValue.data);
}        
</code></pre><h3 id="u4E8C_u3001_u901A_u8FC7_u8D44_u6E90id_u6620_u5C04_u7684_u65B9_u5F0F_u5B9E_u73B0_u591C_u95F4_u6A21_u5F0F"><a href="#u4E8C_u3001_u901A_u8FC7_u8D44_u6E90id_u6620_u5C04_u7684_u65B9_u5F0F_u5B9E_u73B0_u591C_u95F4_u6A21_u5F0F" class="headerlink" title="二、通过资源id映射的方式实现夜间模式"></a>二、通过资源id映射的方式实现夜间模式</h3><p>通过id获取资源时，先将其转换为夜间模式对应id，再通过Resources来获取对应的资源。</p>
<pre><code>public static Drawable getDrawable(Context context, int id) {
    return context.getResources().getDrawable(getResId(id));
}

        public static int getResId(int defaultResId) ｛
            if (!isNightMode()) {
                return defaultResId;
            }
            if (sResourceMap == null) {
                buildResourceMap();
            }
            int themedResId = sResourceMap.get(defaultResId);
            return themedResId == 0 ? defaultResId : themedResId;
        }
</code></pre><p>这里是通过HashMap将白天模式的resId和夜间模式的resId来一一对应起来的。</p>
<pre><code>private static void buildResourceMap() {
    sResourceMap = new SparseIntArray();
    sResourceMap.put(R.drawable.common_background, R.drawable.common_background_night);
    // ...
}
</code></pre><p>这个方案简单粗暴，麻烦的地方和第一种方案一样：每次添加资源都需要建立映射关系，刷新UI的方式也与第一种方案类似，貌似今日头条，网易新闻客户端等主流新闻阅读应用都是通过这种方式实现的夜间模式。</p>
<h3 id="u4E09_u3001_u901A_u8FC7_u4FEE_u6539uiMode_u6765_u5207_u6362_u591C_u95F4_u6A21_u5F0F"><a href="#u4E09_u3001_u901A_u8FC7_u4FEE_u6539uiMode_u6765_u5207_u6362_u591C_u95F4_u6A21_u5F0F" class="headerlink" title="三、通过修改uiMode来切换夜间模式"></a>三、通过修改uiMode来切换夜间模式</h3><p>首先将获取资源的地方统一起来，使用Application对应的Resources，在Application的onCreate中调用ResourcesManager的init方法将其初始化。</p>
<pre><code>public static void init(Context context) {
    sRes = context.getResources();
}
</code></pre><p>切换夜间模式时，通过更新uiMode来更新Resources的配置，系统会根据其uiMode读取对应night下的资源，同时在res中给夜间模式的资源添加-night后缀，比如values-night，drawable-night。</p>
<pre><code>public static void updateNightMode(boolean on) {
    DisplayMetrics dm = sRes.getDisplayMetrics();
    Configuration config = sRes.getConfiguration();
    config.uiMode &amp;= ~Configuration.UI_MODE_NIGHT_MASK;
    config.uiMode |= on ? Configuration.UI_MODE_NIGHT_YES : Configuration.UI_MODE_NIGHT_NO;
    sRes.updateConfiguration(config, dm);
}
</code></pre><p>至于Android的资源读取，我们可以参考老罗的博客《Android应用程序资源的查找过程》，分析看看资源是怎么被精准找到的。这种方法相对前两种的好处就是资源添加非常简单清晰，但是UI上的更新还是无法做到非常顺滑的切换。</p>
<h3 id="u600E_u4E48_u627E_u5230_u7B2C_u4E09_u5F20_u65B9_u6848"><a href="#u600E_u4E48_u627E_u5230_u7B2C_u4E09_u5F20_u65B9_u6848" class="headerlink" title="怎么找到第三张方案"></a>怎么找到第三张方案</h3><p>在Android开发文档中搜索night发现如下，可以通过UiModeManager来实现</p>
<blockquote>
<p>night: Night time<br>notnight: Day time<br>Added in API level 8.</p>
<p>This can change during the life of your application if night mode is left in auto mode (default), in which case the mode changes based on the time of day. You can enable or disable this mode using UiModeManager. See Handling Runtime Changes for information about how this affects your application during runtime.<br>不幸的是必须在驾驶模式下才有效，那是不是打开驾驶模式再设置呢，实际上是不可行的，驾驶模式下系统UI有变动，这样是不可取的。</p>
</blockquote>
<pre><code>/**
* Sets the night mode. Changes to the night mode are only effective when
* the car or desk mode is enabled on a device.
*
* The mode can be one of:
* {@link #MODE_NIGHT_NO}- sets the device into notnight
* mode.
* {@link #MODE_NIGHT_YES} - sets the device into night mode.
* {@link #MODE_NIGHT_AUTO} - automatic night/notnight switching
* depending on the location and certain other sensors.
*/
public void setNightMode(int mode)
</code></pre><p>从源码开始看起，UiModeManagerService.java的setNightMode方法中：</p>
<pre><code>if (isDoingNightModeLocked() &amp;&amp; mNightMode != mode) {
    Settings.Secure.putInt(getContext().getContentResolver(), Settings.Secure.UI_NIGHT_MODE, mode);
    mNightMode = mode;
    updateLocked(0, 0);
}

boolean isDoingNightModeLocked() {
    return mCarModeEnabled || mDockState != Intent.EXTRA_DOCK_STATE_UNDOCKED;
}
</code></pre><p>在 isDoingNightModeLocked中判断了DockState和mCardMode的状态，如果满足条件实际上只修改了mNightMode的值，继续跟踪updateLocked方法，可以看到在updateConfigurationLocked中更新了Configuration的uiMode。</p>
<p>让我们转向Configuration的uiMode的描述：</p>
<pre><code>/**
* Bit mask of the ui mode. Currently there are two fields:
*
The {@link #UI_MODE_TYPE_MASK} bits define the overall ui mode of the
* device. They may be one of {@link #UI_MODE_TYPE_UNDEFINED},
* {@link #UI_MODE_TYPE_NORMAL}, {@link #UI_MODE_TYPE_DESK},
* {@link #UI_MODE_TYPE_CAR}, {@link #UI_MODE_TYPE_TELEVISION},
* {@link #UI_MODE_TYPE_APPLIANCE}, or {@link #UI_MODE_TYPE_WATCH}.
*
*
The {@link #UI_MODE_NIGHT_MASK} defines whether the screen
* is in a special mode. They may be one of {@link #UI_MODE_NIGHT_UNDEFINED},
* {@link #UI_MODE_NIGHT_NO} or {@link #UI_MODE_NIGHT_YES}.
*/
public int uiMode;
</code></pre><p>uiMode为public可以直接设置，既然UiModeManager设置nightMode只改了Configuration的uiMode，那我们是不是可以直接改其uiMode呢？</p>
<p>实际上只需要上面一小段代码就可以实现了，但如果不去查看UiModeManager的夜间模式的实现，不会想到只需要更新Configuration的uiMode就可以了。</p>

      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2016/01/30/Android动态加载技术-系列索引/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          Android动态加载技术 系列索引
        
      </div>
    </a>
  
  
    <a href="/2016/01/30/2016这些Android技术会很火/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">2016这些Android技术会很火</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>


<div class="share_jia">
	<!-- JiaThis Button BEGIN -->
	<div class="jiathis_style">
		<span class="jiathis_txt">分享到: &nbsp; </span>
		<a class="jiathis_button_facebook"></a> 
    <a class="jiathis_button_twitter"></a>
    <a class="jiathis_button_plus"></a> 
    <a class="jiathis_button_tsina"></a>
		<a class="jiathis_button_cqq"></a>
		<a class="jiathis_button_douban"></a>
		<a class="jiathis_button_weixin"></a>
		<a class="jiathis_button_tumblr"></a>
    <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	</div>
	<script type="text/javascript" src="http://v3.jiathis.com/code/jia.js?uid=1405949716054953" charset="utf-8"></script>
	<!-- JiaThis Button END -->
</div>






<div class="duoshuo">
	<!-- 多说评论框 start -->
	<div class="ds-thread" data-thread-key="Android夜间模式最佳实践" data-title="Android夜间模式最佳实践" data-url="http://www.baoxiang.org.cn/2016/01/30/Android夜间模式最佳实践/"></div>
	<!-- 多说评论框 end -->
	<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
	<script type="text/javascript">
	var duoshuoQuery = {short_name:"true"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
	<!-- 多说公共JS代码 end -->
</div>




</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Fang Yuan
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>